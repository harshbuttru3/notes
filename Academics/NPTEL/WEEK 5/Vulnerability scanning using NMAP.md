### Scanning using NMAP Script 
- Thousands of scripts available with NMAP to perform various operations. 
	- Can have own specific requirements, like some services running, port requirements, etc. 
- The detailed guidelines to use NMAP  scripts are available with official website : [Nmap_Manual](https://nmap.org/book/man-nse.html)
- All the scripts related to particular keyword can be otained as : 
		nmap --script "keyword-*"
- Any script can be run using the command : 
		--script <script_name> <port_#if_required> <target_ip> 
- You can find all the scripts by typing the following commands in kali linux command prompt : 
	```bash
	ls -al /usr/share/nmap/scripts
	```
- The scripts can be useful for automated scanning, vulnerability detection, backdoor detection, port detection, etc. 

## Proxy Preparation : 
- After collecting all the necessary information for mounting an attack, we also need to prepare proxy such that the attacker is hidden from the victim system. 
- Proxy servers can be used for : 
	- Work as an intermediary for connecting with victim system. 
	- To hide the source IP address so that an attack can be mounted without any legal corollary. 
	- To mask the actual source of attack by impersonating a fake source address of the proxy. 
- IP spoofing can also be used for the same. 
## System Hacking : 
 System hacking is defined as the compromise of computer systems and software to access a target computer and steal / misuse information stored therein. 
### Password cracking : 
- Set of techniques used to recover passwords from computer systems. 
- Attackers use this techniques to gain unauthorized access to the vulnerable system. 
- Most of these techniques are successfull due to weak  or easily guessable passwords. 
- Some of the well known method of password cracking are : 
	- **Shoulder surfing** : Looking at the user's keyboard or screen while he/she is logging in. 
	- **Social Engineering** : Convincing people to reveal passwords. 
	- **Dictionary Attack** : A dictionary file is used that runs against user accounts. 
	- **Brute-Force Attack** : Try every combination of characters until the password is broken. 
	- **Rule-based Attack** : Used when the attacker gets some information about the password. 
	- **Password Guessing** : The attacker creates a list of all possible passwords from the information collected social engineering or any other way, and tries them manually on the victim's machine to crack the passwords. 
	- **Default Passwords** : Many people do not change the default password of manufacturer. 
	- **Trojan/Spyware/keylogger** : Runs in the background, send back all information to attacker. 
	- **Wire sniffing** : Attackers run packet sniffer tools on the local area network (LAN) to access and record the raw network traffic, which may contain user names and passwords. 
	- **Rainbow Table** : It is a precomputed table that contains word lists like dictionary files and brute force lists and their hash values. 
- Tools Used : 
	- John the ripper, hydra, hashcat, crunch, etc. 
### Privilege Escalation : 
- An attacker can gain access to the network using a  non-admin user account, and the next step would be to gain administrative/root privileges. 
	- Attacker performs privileges escalation attack. 
	- Takes advantages of design flaws, Programming errors, bugs, and configuration oversights in the OS and software application to gain administrative access to the network. 
	- These privileges allows attacker to view critical/sensitive information, delete files, or install malicious programs such as viruses, trojans, worms, etc. 
- Types of  privileges Escalation : 
	- **Vertical Privileges Escalation** : Refers to gaining higher privileges than existing one. 
	- **Horizontal Privileges Escalation** : Refers to acquiring the same level of privileges that already has been granted but assuming the identify of another user with the similar privileges. 
- How to Defend against Privilege Escalation ?
	- Restrict the interactive logon privileges. 
	- Use encryption technique to protect sensitive data. 
	- Run user-level applications on the least privileges. 
	- Reduce the amount of code that runs with particular privilege. 
#### Application Execution and File Hiding : 
- Once the attacker gets username password or privilege: 
	- Executes malicious programs remotely in the victim's machine to gather information that leads to exploitation or loss of privacy, gain unauthorized access to system resources, capture screenshots, install backdoor to maintain easy access, etc. 
- Tools Used : 
	- **PDQ Deploy** : A tool that allows admins to silently install almost any application or patch. 
	- **Dame-Ware Remote Support** : Lets you manage servers, notebooks, and laptops remotely. 
	- **Keylogger**

### Malware : 
- Malicious software that damages or disables computer systems and gives limited or full control to the malware creator for the purpose of theft or fraud. 
- Examples of Malware: 
	- Trojan Horse and Backdoor
	- Rootkit
	- Ransomeware
	- Adware
	- Virus and worms
	- Spyware
	- Botnet
#### How can Malware get into a system?
- Instant Messenger applications. 
- IRC (Internet Relay Chat) 
- Removable Devices
- Attachments
- Browser and email software bugs
- NetBIOS (File sharing)
- Fake Programs 
- Untrusted sites and freeware software. 

### Trojan : 
- A program where malicious code is contained inside apparently harmless code or data in such a way that it can get control and cause damage. 
- They get activated upon user's certain predefined actions. 
- Indications of a Trojan attack include abnormal system and network activites such as disabling of antivirus, redirection to unknown pages, etc. 
- Trojans create a covert communication channel between victim computer and attacker for transferring sensitive data. 
## How Hackers use Trojans ?
- Delete or replace OS's critical files. 
- Generate fake traffic to create DoS attacks. 
- Record screenshots, audio , and video of victim's PC. 
- Use Victim's PC for spamming and blasting email messages. 
- Download spyware, adware, and malicious files. 
- Disable firewalls and antivirus. 
- Create backdoors to gain remote access. 
- Infect victim's PC as a proxy server for replaying attacks. 
- Use victim's PC as a botnet to perform DDoS attacks. 
### Virus and Worm 
- A virus is a self-replicating program that produces its own copy by attaching itself to another program, computer boot sector or document. 
	- Generally transmitted through file downloads, infected drives, as email attachments, etc. 
- Virus characteristics : 
	- Stages of infecting other program.
	- Transforms itself
	- Encrypts itself
	- Alters data
	- Corrupts files and programs.
- **Infection Phase :** The virus replicates itself and attaches to an .exe file. 
- **Attack phase :** Viruses are programmed with trigger events to activate and corrupt systems. 
	- Some viruses infect each time they are run, and others infect only when a certain predefined condition is met. 
- Types of viruses : 
	- Virus hoax
	- Spooky virus
	- Stealth virus 
	- Polymorphic virus 
### Ransomware
It is a type of a malware that restricts access to the computer system's files and folders, and demands an online ransom payment to the malware creator(s) in order to remove the restrictions.

#### Countermeasures against Malware, Trojans, etc. 
- Use of authentic antivirus tools. 
- Use of firewalls - both personal and organization-level 
- Update software on time. 
- Avoid visiting malicious websites. 
- Do not use obvious passwords. 
- Ignore unknown mails. 

![[Pasted image 20251019201959.png]]
![[Pasted image 20251019202025.png]]

## Packet sniffing : 
- It is a process of monitoring and capturing all data passing through a given network using sniffing tools. 
	- It is a form of wiretap applied to computer networks. 
- Many enterprise's switch ports are open. 
	- Anyone in the same physical location can plug into the network using an Ethernet cable. 
#### How Packet Sniffer Works ?
- **Promiscuous Mode :** The tools turns the NIC of a system to the promiscuous mode so that it listens to all the data transmitted on its segment. 
- **Decode Information :** A sniffer can constantly monitor all the network traffic to a computer through the NIC by decoding the information encapsulated in the data packet.
#### Types of Sniffing : 
- **Passive Sniffing :** It means sniffing through a hub, where traffic is sent to all ports. It involves only monitoring of the packets sent by others without sending any additional data packets in the network traffic. 
	- In a network that use hubs to connect systems, all hosts can see all traffic --attacker can easily capture traffic going through the hub. 
	- Hub usage is outdated today --Most modern networks use switches. 
- **Active Sniffing :** This is used to sniff a switch-based network.
	- Involves ARP packets into the network to flood the switch's CAM table. 
	- CAM keeps track of which host is connected to which port. 
#### Vulnerable Protocols : 
- **HTTP** : data sent in clear text. 
- **Telnet** and **Rlogin** : Keystrokes including user names and passwords. 
- **POP** : Passwords and data sent in clear text. 
- **IMAP** : Passwords and data sent in clear text. 
- **SMTP** and **NNTP** : Passwords and data sent in clear text. 
- **FTP** : Passwords and data sent in clear text. 
### Mac Attack : 
- Each switch has a fixed size dynamic Content Addressable Memory (CAM) table.
	- The table stores MAC addresses available on ports with their associated VLAN parameters. 
	- Once the table on the switch is full, additional ARP request traffic will flood every port on the switch (like a hub). 
	- This will change the behavior of the switch to reset to its learning mode. 
- This attack will also fill the CAM tables of adjacent switches. 
	- MAC flooding
	- involves flooding of CAM table with  fake MAC address and IP pairs until it is full. 
### DHCP Starvation Attack 
- DHCP servers maintain TCP/IP configuration information in database. 
	- valid TCP/IP configuration parameters, IP addresses, duration of lease offered by the server. 
- DHCP Starvation Attack : 
	- A  DOS attack on the DHCP servers where attacker broadcasts forged DHCP requests and tries to lease all of the DHCP addresses available in the DHCP scope. 
- Legitimate user is unable to obtain or renew an IP address requested via DHCP. 

### ARP Spoofing 
- ARP packets can be forged to send data to the attacker's machine. 
- ARP spoofing involves constructing a large number of forged ARP request and reply packets to overload a switch. 
	- Switch is set in "forwarding mode" after ARP table is flooded with spoofed ARP replies and attackers can sniff all the network packets. 
	- Attackers flood a target computer's ARP cache with forged entries, which is also known as **poisoning**. 
### ARP Poisoning 
- Using fake ARP messages, an attacker can divert all communications between two machines so that all traffic exchanged via his/her PC.
- The threats of ARP poisoning include : 
	- Packet Sniffing, Session Hijacking, VoIP Call Tapping, Manipulating Data, Man-in-the-middle Attack, Data Interception, Connection Hijacking and resetting, Steal Passwords, DoS attack. 
- ARP poisoning tools : 
	- **Cain & Abel** and **WinArpAttacker**
